package com.softwareloop.tstconfig;

import java.util.ArrayList;

/**
 * Created by predo on 14/08/14.
 */
public class UfwConfig extends Config {

    //--------------------------------------------------------------------------
    // Constants
    //--------------------------------------------------------------------------

    enum State {
        HEADER,
        RULES
    }

    //--------------------------------------------------------------------------
    // Fields
    //--------------------------------------------------------------------------

    State state;

    //--------------------------------------------------------------------------
    // Constructors
    //--------------------------------------------------------------------------

    public UfwConfig() {
        setParseMode(ParseMode.KEYVALUE);
        setKeySeparator(":");
        setSeparator(null);
        state = State.HEADER;
        sections.put("rules", new ArrayList<String[]>());
    }


    //--------------------------------------------------------------------------
    // AbstractKeyValueConfig implementation
    //--------------------------------------------------------------------------

    @Override
    public void parseBlankLine(String line) {
        if (state == State.HEADER) {
            setParseMode(ParseMode.FIXED);
            setPositions(27, 39);
            state = State.RULES;
            currentSection = sections.get("rules");
        }
    }

    //--------------------------------------------------------------------------
    // Methods
    //--------------------------------------------------------------------------

    //--------------------------------------------------------------------------
    // Abstract methods
    //--------------------------------------------------------------------------

    //--------------------------------------------------------------------------
    // Getters/setters
    //--------------------------------------------------------------------------

}
